--Command to Create Database

CREATE DATABASE BANKDATABASE

--Command to use Database

USE BANKDATABASE

--Command to Create Table

CREATE TABLE CUSTOMER_PERSONAL_INFO(
CUSTOMERID VARCHAR(5),
CUSTOMER_NAME VARCHAR(30),
DATE_OF_BIRTH DATE,
GUARDIAN_NAME VARCHAR(30),
ADDRESS VARCHAR(100),
CONTACT_NO VARCHAR(12),
MAIL_ID VARCHAR(30),
GENDER CHAR(1),
MARITAL_STATUS VARCHAR(10),
IDENTIFICATION_DOC_TYPE VARCHAR(20),
ID_DOC_NO VARCHAR(20),
CITIZENSHIP VARCHAR(10),
PRIMARY KEY(CUSTOMERID)
);

--Command to Create Table

CREATE TABLE CUSTOMER_REFRENCE_INFO(
CUSTOMERID VARCHAR(5),
REFRENCE_ACCOUNT_NAME VARCHAR(20),
REFRENCE_ACCOUNT_NUMBER BIGINT,
REFRENCE_ACCOUNT_ADDRESS VARCHAR(50),
RELATION VARCHAR(25)
);

-- Command to Insert Data into Table

INSERT INTO CUSTOMER_PERSONAL_INFO VALUES('107','vikas sahu','1994-08-31','shivam sahu','Ranchi','9089888125','vikaa@gmail.com','M','Unmarried','Aadhar Card','88985864112852','Indian');

--Command to reterive data from respective table

SELECT * FROM CUSTOMER_PERSONAL_INFO

--Command to display structure of table

SP_HELP CUSTOMER_REFRENCE_INFO

-- Command to Insert Data into Table

INSERT INTO CUSTOMER_REFRENCE_INFO VALUES(105,'Vikas Sahu',256489548,'Noida Sector-19','Office College')

--Command to reterive data from respective table

select * from CUSTOMER_REFRENCE_INFO

--Command to reterive data from more then one table

--Inner Join:---
SELECT * FROM CUSTOMER_PERSONAL_INFO CPI INNER JOIN CUSTOMER_REFRENCE_INFO CRI ON CPI.CUSTOMERID=CRI.CUSTOMERID
SELECT CPI.CUSTOMERID,CPI.CUSTOMER_NAME,CPI.GUARDIAN_NAME,CPI.ID_DOC_NO,CRI.REFRENCE_ACCOUNT_NAME,CRI.REFRENCE_ACCOUNT_NUMBER,CRI.REFRENCE_ACCOUNT_ADDRESS,CRI.RELATION FROM CUSTOMER_PERSONAL_INFO CPI INNER JOIN CUSTOMER_REFRENCE_INFO CRI ON CPI.CUSTOMERID=CRI.CUSTOMERID


--LEFT JOIN--

SELECT * FROM CUSTOMER_PERSONAL_INFO CPI LEFT JOIN CUSTOMER_REFRENCE_INFO CRI ON CPI.CUSTOMERID=CRI.CUSTOMERID
SELECT CPI.CUSTOMERID,CPI.CUSTOMER_NAME,CPI.CITIZENSHIP,CRI.REFRENCE_ACCOUNT_NAME,CRI.REFRENCE_ACCOUNT_NUMBER,CRI.RELATION FROM CUSTOMER_PERSONAL_INFO CPI LEFT JOIN CUSTOMER_REFRENCE_INFO CRI ON CPI.CUSTOMERID=CRI.CUSTOMERID


--RIGHT JOIN--

SELECT * FROM CUSTOMER_PERSONAL_INFO CPI RIGHT JOIN CUSTOMER_REFRENCE_INFO CRI ON CPI.CUSTOMERID=CRI.CUSTOMERID
SELECT CPI.CUSTOMERID,CPI.CUSTOMER_NAME,CPI.CITIZENSHIP,CRI.REFRENCE_ACCOUNT_NAME,CRI.REFRENCE_ACCOUNT_NUMBER,CRI.RELATION FROM CUSTOMER_PERSONAL_INFO CPI RIGHT JOIN CUSTOMER_REFRENCE_INFO CRI ON CPI.CUSTOMERID=CRI.CUSTOMERID


--FULL JOIN

SELECT * FROM CUSTOMER_PERSONAL_INFO CPI FULL OUTER JOIN CUSTOMER_REFRENCE_INFO CRI ON CPI.CUSTOMERID=CRI.CUSTOMERID
SELECT CPI.CUSTOMERID,CPI.CUSTOMER_NAME,CPI.CITIZENSHIP,CRI.REFRENCE_ACCOUNT_NAME,CRI.REFRENCE_ACCOUNT_NUMBER,CRI.RELATION FROM CUSTOMER_PERSONAL_INFO CPI FULL OUTER JOIN CUSTOMER_REFRENCE_INFO CRI ON CPI.CUSTOMERID=CRI.CUSTOMERID ORDER BY CPI.CUSTOMER_NAME

--SELF JOIN

SELECT CPI.CUSTOMER_NAME AS CUSTOMER_NAME1, CRI.CUSTOMER_NAME AS CUSTOMER_NAME2, CRI.ADDRESS
FROM CUSTOMER_PERSONAL_INFO CPI, CUSTOMER_PERSONAL_INFO CRI
WHERE CPI.CUSTOMERID <> CRI.CUSTOMERID
AND CPI.ADDRESS = CRI.ADDRESS
ORDER BY CPI.ADDRESS;

--STORED PROCEDURES

--Write A Sp to Insert data from CUSTOMER_PERSONAL_INFO

CREATE PROC CPIINSERT_SP
@CUSTOMERID VARCHAR(5),
@CUSTOMER_NAME VARCHAR(30),
@DATE_OF_BIRTH DATE,
@GUARDIAN_NAME VARCHAR(30),
@ADDRESS VARCHAR(100),
@CONTACT_NO VARCHAR(12),
@MAIL_ID VARCHAR(30),
@GENDER CHAR(1),
@MARITAL_STATUS VARCHAR(10),
@IDENTIFICATION_DOC_TYPE VARCHAR(20),
@ID_DOC_NO VARCHAR(20),
@CITIZENSHIP VARCHAR(10)
AS
BEGIN
INSERT INTO CUSTOMER_PERSONAL_INFO (CUSTOMERID,CUSTOMER_NAME,DATE_OF_BIRTH,GUARDIAN_NAME,ADDRESS,CONTACT_NO,MAIL_ID,GENDER,MARITAL_STATUS,IDENTIFICATION_DOC_TYPE,ID_DOC_NO,CITIZENSHIP)
VALUES (@CUSTOMERID,@CUSTOMER_NAME,@DATE_OF_BIRTH,@GUARDIAN_NAME,@ADDRESS,@CONTACT_NO,@MAIL_ID,@GENDER,@MARITAL_STATUS,@IDENTIFICATION_DOC_TYPE,@ID_DOC_NO,@CITIZENSHIP)
END

--Write A Sp to reterive data from CUSTOMER_PERSONAL_INFO

CREATE PROC CPISELECT_SP
AS
BEGIN
SELECT * FROM CUSTOMER_PERSONAL_INFO
END

--Write A Sp to Update data from CUSTOMER_PERSONAL_INFO

CREATE PROC CPIUPDATE_SP
@CUSTOMERID VARCHAR(5)
AS
BEGIN
UPDATE CUSTOMER_PERSONAL_INFO SET CUSTOMER_NAME='Rakesh Singh' WHERE CUSTOMERID=@CUSTOMERID
END

--Write A Sp to Delete data from CUSTOMER_PERSONAL_INFO

CREATE PROC CPIDELETE_SP
@CUSTOMERID VARCHAR(5)
AS
BEGIN
DELETE FROM CUSTOMER_PERSONAL_INFO WHERE CUSTOMERID=@CUSTOMERID
END

--How to Execute stored procedure

EXEC CPISELECT_SP
EXEC CPIUPDATE_SP '101'
EXEC CPIDELETE_SP '107'
